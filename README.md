## FloorPlan 3D: Архітектурна основа для комерційних редакторів інтер'єру

**FloorPlan 3D** — це не просто демонстраційний проєкт, а **потужна архітектурна основа (boilerplate)**, призначена для створення повноцінних комерційних десктопних редакторів інтер'єру. Додаток демонструє ключові механіки, необхідні для таких продуктів, включаючи два режими редагування (2D/3D), параметричне створення геометрії, інтерактивну бібліотеку об'єктів та детальну панель властивостей. Проєкт розроблений з акцентом на масштабованість, що дозволяє легко розширювати його функціонал та наповнювати контентом.

### Ключові можливості

*   **Подвійний режим редагування: 2D та 3D**
    *   Миттєве перемикання між видом зверху (2D-план) для зручного креслення та повноцінною 3D-перспективою для візуалізації та декорування.

*   **Параметричне створення стін**
    *   Інтуїтивне малювання стін та їх редагування за допомогою інтерактивних маніпуляторів (`ResizeHandle`).
    *   Реалізовано алгоритм "прилипання" стін одна до одної та автоматичне створення правильних кутових з'єднань (`Miter Joints`).

*   **Динамічні архітектурні елементи**
    *   Додавання вікон та дверей, які автоматично "вирізають" отвори у стінах за допомогою булевих CSG-операцій в реальному часі.

*   **Drag-and-Drop бібліотека об'єктів**
    *   Організована бібліотека 3D-моделей (меблі, декор), які можна перетягувати безпосередньо у сцену.
    *   Реалізовано спливаючі підказки з великим прев'ю моделі при наведенні.

*   **Інтерактивні 3D-маніпулятори (Gizmo)**
    *   Виділені об'єкти можна легко переміщувати, обертати та масштабувати за допомогою централізованого компонента `TransformControls`.

*   **Детальна панель властивостей**
    *   Контекстно-залежна панель, яка дозволяє точно налаштовувати розміри, позицію, обертання та матеріали будь-якого виділеного об'єкта.
    *   Реалізовано візуальний селектор текстур з фільтрацією за тегами (напр., "для підлоги", "для стін").

*   **Збереження та завантаження сцени**
    *   Повна серіалізація стану сцени (включаючи об'єкти, їх властивості та ієрархію) у JSON-файл для збереження та подальшого завантаження проєктів.

*   **Повністю офлайн-робота**
    *   Додаток скомпільовано за допомогою **Electron**, що дозволяє йому працювати як самостійна десктопна програма на Windows, macOS та Linux без доступу до інтернету.


### Система автоматичної генерації прев'ю та метаданих

Для підтримки та легкого розширення бібліотеки 3D-об'єктів було розроблено спеціалізований внутрішній інструмент — **генератор прев'ю та метаданих**. Ця система повністю автоматизує процес створення візуальних іконок та збору технічних даних для кожного елемента бібліотеки, усуваючи необхідність у ручному створенні скріншотів та введенні даних, що гарантує консистентність та мінімізує ризик помилок.

### Ключові можливості системи

*   **WYSIWYG (What You See Is What You Get) рендеринг:** Система генерує прев'ю не з "сирих" 3D-моделей, а з **повністю сконфігурованих елементів**, як вони описані в `library-config.js`. Це означає, що якщо для моделі вказані специфічні заміни матеріалів або трансформації, вони будуть застосовані перед рендерингом, і фінальне зображення буде на 100% відповідати тому, як об'єкт виглядатиме в сцені.

*   **Автоматичне вилучення метаданих:** Під час рендерингу система аналізує 3D-об'єкт і автоматично збирає ключові технічні дані:
    *   **Фінальні розміри (габарити):** Точні розміри об'єкта в метрах після застосування всіх масштабів.
    *   **Кількість полігонів:** Важливий показник продуктивності моделі.
    *   **Список матеріалів:** Повний перелік імен матеріалів, що використовуються в моделі (з урахуванням замін).

*   **Підтримка всіх типів компонентів:** Генератор є універсальним і може обробляти як **статичні 3D-моделі** (наприклад, меблі з `.glb` файлів), так і **процедурні компоненти** (наприклад, стіни, які генеруються програмно).

*   **Централізований вивід даних:** Результатом роботи системи:
    1.  **Набір PNG-зображень:** Високоякісні прев'ю для кожного елемента бібліотеки.
    2.  **Єдиний файл `model-metadata.json`:** JSON-файл, що слугує "єдиним джерелом правди" про всі технічні характеристики об'єктів. Основний додаток завантажує цей файл для відображення даних у бібліотеці.


### Переваги даного підходу

*   **Масштабованість:** Додавання сотень нових елементів у бібліотеку не потребує ручної роботи — достатньо запустити генератор.
*   **Консистентність:** Усі прев'ю мають однаковий стиль, освітлення та ракурс, що робить бібліотеку візуально цілісною.
*   **Точність:** Технічні дані (розміри, полігони) вилучаються автоматично, що виключає людський фактор та помилки.
*   **Продуктивність:** Вся "важка" робота з аналізу моделей виконується один раз, офлайн. Основний додаток завантажує лише легкий та швидкий JSON-файл, не витрачаючи ресурси користувача.



### Технологічний стек

*   **Frontend:** React
*   **3D-графіка:** Three.js, React Three Fiber (R3F), React Three Drei
*   **Керування станом:** Zustand (з middleware Immer)
*   **Десктопна платформа:** Electron
*   **Додаткові бібліотеки:** `three-csg-ts` (для булевих операцій), `Tippy.js` (для підказок).


### Архітектурні особливості

*   **Динамічний рендеринг компонентів:** Сцена будується на основі даних зі стору, використовуючи `componentMap` для рендерингу відповідних React-компонентів.
*   **Централізоване керування станом:** Увесь стан сцени зберігається в єдиному сторі Zustand, що забезпечує передбачуваність та легкість відладки.
*   **Data-Driven UI:** Панель властивостей для кожного об'єкта генерується динамічно на основі його статичної схеми (`propertySchema`), що робить додавання нових об'єктів простим та масштабованим.



### Проєкт як основа для комерційного продукту

Завдяки продуманій архітектурі та масштабованому підходу, цей проєкт є ідеальною відправною точкою для розробки фінального комерційного продукту.

**Що вже реалізовано (фундамент):**
*   **Масштабована система компонентів:** Легко додавати нові типи об'єктів (наприклад, сходи, колони, плінтуси), просто створивши новий компонент та описавши його `propertySchema`.
*   **Централізований та передбачуваний менеджмент стану:** Готова система для роботи зі складними сценами та їх властивостями.
*   **Готова архітектура для десктопного офлайн-додатку:** Вирішено всі основні проблеми збірки та розповсюдження.

**Напрямки для подальшого розвитку:**
*   **Розширення бібліотек:** Легке додавання сотень нових 3D-моделей меблів, текстур та матеріалів.
*   **Розширений редактор матеріалів:** Можливість змінювати не тільки текстуру, але й колір, шорсткість, металевість матеріалів.
*   **Інтеграція бізнес-логіки:** Автоматичний підрахунок площі приміщень, вартості матеріалів, генерація специфікацій та кошторисів.
*   **Покращення якості рендерингу:** Додавання глобального освітлення (Ambient Occlusion), більш реалістичних тіней та ефектів постобробки.
